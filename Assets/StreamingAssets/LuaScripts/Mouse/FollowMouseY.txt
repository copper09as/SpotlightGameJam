local GC = CS.GameController

function FollowMouseY(entity, dt)
    local data = entity.dataTable
    local mousePos = GC.GetScreenPos()

    -- 限制鼠标 Y 坐标在屏幕区域
    mousePos.y = CS.UnityEngine.Mathf.Clamp(mousePos.y, data.limitYMin, data.limitYMax)

    -- 转换成世界坐标
    local cam = CS.UnityEngine.Camera.main
    local worldPos = cam:ScreenToWorldPoint(mousePos)

    -- 平滑插值移动
    local pos = entity.transform.position
    local targetY = worldPos.y
    local followSpeed = data.scrollSpeed
    pos.y = CS.UnityEngine.Mathf.Lerp(pos.y, targetY, followSpeed * dt)

    -- 再做一次最终 Clamp（防止插值后超限）
    local clampedScreenY = CS.UnityEngine.Mathf.Clamp(cam:WorldToScreenPoint(pos).y, data.limitYMin, data.limitYMax)
    local finalWorldPos = cam:ScreenToWorldPoint(CS.UnityEngine.Vector3(mousePos.x, clampedScreenY, mousePos.z))
    pos.y = finalWorldPos.y

    entity.transform.position = pos

    local rangeY = data.limitYMax - data.limitYMin
    local targetProgress = (mousePos.y - data.limitYMin) / rangeY
    local smoothFactor = data.scrollSmooth or 5
    data.scrollProgress = CS.UnityEngine.Mathf.Lerp(data.scrollProgress, targetProgress, smoothFactor * dt)
end
